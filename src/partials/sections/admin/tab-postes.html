<!-- Tab: Postes -->
<div x-show="activeTab === 'postes'">
    <div class="brutal-card bg-brutal-white p-8 mb-8">
        <h2 class="text-3xl font-black mb-6" x-text="editingPoste ? 'Modifier un poste' : 'Ajouter un poste'"></h2>

        <form @submit.prevent="savePoste()">
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block font-bold mb-2">Titre *</label>
                    <input type="text" x-model="posteForm.titre" required class="brutal-input w-full px-4 py-3"
                        placeholder="Juge de bloc" />
                </div>

                <div>
                    <label class="block font-bold mb-2">P√©riode *</label>
                    <select x-model="posteForm.periode_id" required class="brutal-input w-full px-4 py-3 font-bold">
                        <option value="">-- S√©lectionnez une p√©riode --</option>
                        <template x-for="periode in periodes" :key="periode.id">
                            <option :value="periode.id" x-text="periode.nom"></option>
                        </template>
                    </select>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block font-bold mb-2">D√©but *</label>
                    <input type="datetime-local" x-model="posteForm.periode_debut" required
                        class="brutal-input w-full px-4 py-3" />
                </div>

                <div>
                    <label class="block font-bold mb-2">Fin *</label>
                    <input type="datetime-local" x-model="posteForm.periode_fin" required
                        class="brutal-input w-full px-4 py-3" />
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block font-bold mb-2">Minimum *</label>
                    <input type="number" x-model.number="posteForm.nb_min" required min="1"
                        class="brutal-input w-full px-4 py-3" />
                </div>

                <div>
                    <label class="block font-bold mb-2">Maximum *</label>
                    <input type="number" x-model.number="posteForm.nb_max" required min="1"
                        class="brutal-input w-full px-4 py-3" />
                </div>
            </div>

            <div class="mb-4">
                <label class="block font-bold mb-2">R√©f√©rent</label>
                <select x-model="posteForm.referent_id" class="brutal-input w-full px-4 py-3 font-bold">
                    <option value="">-- Aucun r√©f√©rent --</option>
                    <template x-for="benevole in getReferents()" :key="benevole.id">
                        <option :value="benevole.id" x-text="benevole.prenom + ' ' + benevole.nom"></option>
                    </template>
                </select>
            </div>

            <div class="mb-6">
                <label class="block font-bold mb-2">Description</label>
                <textarea x-model="posteForm.description" class="brutal-input w-full px-4 py-3" rows="3"
                    placeholder="D√©tails du poste..."></textarea>
            </div>

            <div class="flex gap-4">
                <button type="submit" :disabled="loading"
                    class="brutal-btn bg-brutal-ice flex-1 py-4 text-xl shadow-brutal">
                    <span x-show="!loading" x-text="editingPoste ? 'üíæ Enregistrer' : '‚úÖ Cr√©er le poste'"></span>
                    <span x-show="loading">‚è≥ Enregistrement...</span>
                </button>

                <button x-show="editingPoste" type="button" @click="cancelEdit()"
                    class="brutal-btn bg-gray-300 px-6 py-4 text-xl shadow-brutal">
                    ‚ùå Annuler
                </button>
            </div>
        </form>
    </div>

    <!-- Liste des postes -->
    <div class="brutal-card bg-brutal-white p-8">
        <h2 class="text-3xl font-black mb-6">Liste des postes</h2>

        <!-- Vue Desktop (Tableau) -->
        <div class="hidden md:block overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b-4 border-brutal-black">
                        <th class="text-left py-3 px-2 font-black">Titre</th>
                        <th class="text-left py-3 px-2 font-black">P√©riode</th>
                        <th class="text-left py-3 px-2 font-black">Horaires</th>
                        <th class="text-left py-3 px-2 font-black">R√©f√©rent</th>
                        <th class="text-left py-3 px-2 font-black">Min / Max</th>
                        <th class="text-left py-3 px-2 font-black">Inscrits</th>
                        <th class="text-left py-3 px-2 font-black">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="poste in postes" :key="poste.id">
                        <tr class="border-b-2 border-gray-300">
                            <td class="py-3 px-2 font-bold" x-text="poste.titre"></td>
                            <td class="py-3 px-2 font-bold" x-text="poste.periode_nom"></td>
                            <td class="py-3 px-2 font-bold text-sm">
                                <span x-text="formatDateTime(poste.periode_debut)"></span><br>
                                <span x-text="formatDateTime(poste.periode_fin)"></span>
                            </td>
                            <td class="py-3 px-2 font-bold" x-text="poste.referent_identite"></td>
                            <td class="py-3 px-2 font-bold text-center">
                                <span x-text="poste.nb_min"></span> / <span x-text="poste.nb_max"></span>
                            </td>
                            <td class="py-3 px-2 font-bold text-center">
                                <span x-text="poste.inscrits_actuels || 0"></span>
                            </td>
                            <td class="py-3 px-2">
                                <div class="flex gap-2">
                                    <button @click="editPoste(poste)"
                                        class="brutal-btn bg-brutal-ice px-4 py-2 shadow-brutal-sm text-sm">
                                        ‚úèÔ∏è Modifier
                                    </button>
                                    <button @click="deletePoste(poste.id)"
                                        class="brutal-btn bg-red-500 text-white px-4 py-2 shadow-brutal-sm text-sm">
                                        üóëÔ∏è Supprimer
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>

        <!-- Vue Mobile (Cartes) -->
        <div class="md:hidden space-y-4">
            <template x-for="poste in postes" :key="poste.id">
                <div class="border-2 border-brutal-black bg-gray-50 p-4 shadow-brutal-sm">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-black text-lg" x-text="poste.titre"></h3>
                        <span class="bg-brutal-yellow px-2 py-1 text-xs font-bold border border-brutal-black"
                            x-text="poste.periode_nom"></span>
                    </div>

                    <div class="grid grid-cols-2 gap-2 text-sm mb-3">
                        <div>
                            <span class="font-bold block text-gray-600">D√©but:</span>
                            <span x-text="formatDateTime(poste.periode_debut)"></span>
                        </div>
                        <div>
                            <span class="font-bold block text-gray-600">Fin:</span>
                            <span x-text="formatDateTime(poste.periode_fin)"></span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <span class="font-bold block text-gray-600 text-sm">R√©f√©rent:</span>
                        <span x-text="poste.referent_identite || 'Aucun'" class="font-medium"></span>
                    </div>

                    <div class="flex justify-between items-center bg-white border border-gray-200 p-2 mb-4">
                        <div class="text-center">
                            <span class="block text-xs font-bold text-gray-500">MIN</span>
                            <span class="font-black text-lg" x-text="poste.nb_min"></span>
                        </div>
                        <div class="text-center border-l border-r border-gray-200 px-4">
                            <span class="block text-xs font-bold text-gray-500">MAX</span>
                            <span class="font-black text-lg" x-text="poste.nb_max"></span>
                        </div>
                        <div class="text-center">
                            <span class="block text-xs font-bold text-gray-500">INSCRITS</span>
                            <span class="font-black text-lg text-brutal-blue"
                                x-text="poste.inscrits_actuels || 0"></span>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <button @click="editPoste(poste)"
                            class="brutal-btn bg-brutal-ice w-full py-2 text-sm shadow-brutal-sm flex justify-center items-center gap-1">
                            ‚úèÔ∏è Modifier
                        </button>
                        <button @click="deletePoste(poste.id)"
                            class="brutal-btn bg-red-500 text-white w-full py-2 text-sm shadow-brutal-sm flex justify-center items-center gap-1">
                            üóëÔ∏è Supprimer
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>