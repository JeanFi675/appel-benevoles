<!-- Section Gestion Profils -->
<div x-show="user && (profiles.length === 0 || showProfileSection)" class="brutal-card bg-brutal-white p-4 mb-6">

    <!-- VUE LISTE -->
    <div x-show="!isEditingProfile">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-black">üë§ Mes B√©n√©voles</h2>
            <button @click="createProfile()" class="brutal-btn bg-brutal-ice px-4 py-2 shadow-brutal-sm text-sm">
                + Ajouter
            </button>
        </div>

        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
            <template x-for="p in profiles" :key="p.id">
                <div class="border-2 border-brutal-black p-4 bg-gray-50 relative">
                    <h3 class="font-bold text-xl" x-text="p.prenom + ' ' + p.nom"></h3>
                    <p class="text-gray-600" x-text="p.email"></p>
                    <p class="text-sm mt-2">üëï Taille: <span x-text="p.taille_tshirt"></span></p>
                    <div class="mt-2 text-sm">
                        <p x-show="p.repas_vendredi">üçΩÔ∏è <span class="font-bold">Repas Ven. soir 15</span></p>
                        <p x-show="p.repas_samedi">üçΩÔ∏è <span class="font-bold">Repas Sam. soir 16</span></p>
                    </div>

                    <div class="flex gap-2 mt-4">
                        <button @click="editProfile(p.id)"
                            class="flex-1 brutal-btn bg-white border-2 border-black py-2 text-sm hover:bg-gray-100">
                            ‚úèÔ∏è Modifier
                        </button>
                        <button @click="deleteProfile(p.id)"
                            class="brutal-btn bg-red-500 text-white border-2 border-black py-2 px-4 text-sm hover:bg-red-600">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            </template>

            <!-- Empty state -->
            <div x-show="profiles.length === 0" class="col-span-full text-center py-8 text-gray-500 italic">
                Aucun profil b√©n√©vole. Cr√©ez-en un pour commencer !
            </div>
        </div>

        <div class="mt-6 text-right" x-show="profiles.length > 0">
            <button @click="toggleProfileSection()" class="underline font-bold text-gray-600">
                Fermer et voir les postes
            </button>
        </div>
    </div>

    <!-- VUE FORMULAIRE (Cr√©ation / Edition) -->
    <div x-show="isEditingProfile">
        <h2 class="text-2xl font-black mb-4" x-text="profileForm.id ? 'Modifier le profil' : 'Nouveau b√©n√©vole'"></h2>

        <form @submit.prevent="saveProfile()">
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block font-bold mb-2">Pr√©nom *</label>
                    <input type="text" x-model="profileForm.prenom" required class="brutal-input w-full px-4 py-2"
                        placeholder="Jean" />
                </div>

                <div>
                    <label class="block font-bold mb-2">Nom *</label>
                    <input type="text" x-model="profileForm.nom" required class="brutal-input w-full px-4 py-2"
                        placeholder="Dupont" />
                </div>
            </div>

            <div class="mb-4">
                <label class="block font-bold mb-2">T√©l√©phone *</label>
                <input type="tel" x-model="profileForm.telephone" class="brutal-input w-full px-4 py-2"
                    placeholder="06 12 34 56 78" />
            </div>

            <div class="mb-6">
                <label class="block font-bold mb-2">Taille T-shirt *</label>
                <select x-model="profileForm.taille_tshirt" required class="brutal-input w-full px-4 py-2 font-bold">
                    <option value="">-- S√©lectionnez --</option>
                    <option value="XS">XS</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="XXL">XXL</option>
                </select>
                </select>
            </div>

            <div class="mb-6 p-4 bg-yellow-50 border-2 border-yellow-400">
                <h3 class="font-bold mb-2">üçΩÔ∏è Repas B√©n√©voles (soir)</h3>
                <p class="text-sm mb-4">Afin de pr√©voir les quantit√©s, merci de nous indiquer votre pr√©sence aux repas offerts aux b√©n√©voles.</p>
                
                <div class="flex items-center gap-3 mb-2">
                    <input type="checkbox" id="repas_vendredi" x-model="profileForm.repas_vendredi" class="w-6 h-6 accent-brutal-black">
                    <label for="repas_vendredi" class="font-bold cursor-pointer">Pr√©sent pour le repas du vendredi soir (15 mai 2026)</label>
                </div>

                <div class="flex items-center gap-3">
                    <input type="checkbox" id="repas_samedi" x-model="profileForm.repas_samedi" class="w-6 h-6 accent-brutal-black">
                    <label for="repas_samedi" class="font-bold cursor-pointer">Pr√©sent pour le repas du samedi soir (16 mai 2026)</label>
                </div>
            </div>

            <div class="flex flex-col md:flex-row gap-4">
                <button type="submit" :disabled="loading"
                    class="brutal-btn bg-brutal-ice w-full py-2 text-lg shadow-brutal">
                    <span x-show="!loading">‚úÖ Enregistrer</span>
                    <span x-show="loading">‚è≥ Enregistrement...</span>
                </button>

                <button type="button" @click="cancelEdit()"
                    class="brutal-btn bg-gray-200 text-black w-full md:w-auto py-2 text-lg shadow-brutal-sm">
                    Annuler
                </button>
            </div>
        </form>
    </div>
</div>