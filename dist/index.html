<!doctype html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BÃ©nÃ©voles Escalade - Inscription</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet"><script type="module" crossorigin src="./assets/index-BI7heHru.js"></script><link rel="stylesheet" crossorigin href="./assets/index-CyFBLpDP.css"></head><body class="bg-brutal-ice min-h-screen" x-data="app()" x-init="init()"><div class="fixed top-4 right-4 z-50 space-y-2"><template x-for="toast in toasts" :key="toast.id"><div class="toast brutal-card px-6 py-4 max-w-md" :class="toast.type === 'error' ? 'bg-brutal-black text-brutal-ice' : 'bg-brutal-ice text-brutal-black'"><p class="font-bold" x-text="toast.message"></p></div></template></div><header class="bg-brutal-black text-brutal-white py-8 mb-8 border-b-8 border-brutal-black"><div class="container mx-auto px-4"><h1 class="text-5xl font-black text-center tracking-tight">ğŸ§— BÃ‰NÃ‰VOLES ESCALADE</h1><p class="text-center mt-2 text-xl font-body">Inscrivez-vous pour aider la compÃ©tition</p></div></header><main class="container mx-auto px-4 pb-12"><section class="mb-12" x-show="!user"><div class="max-w-md mx-auto"><div class="brutal-card bg-brutal-white p-8"><h2 class="text-3xl font-black mb-6">Connexion</h2><form @submit.prevent="sendMagicLink()"><div class="mb-4"><label for="email" class="block font-bold mb-2 text-lg">Votre email</label> <input type="email" id="email" x-model="loginEmail" required placeholder="jean.dupont@example.com" class="brutal-input w-full px-4 py-3 text-lg"/></div><button type="submit" :disabled="loading" class="brutal-btn bg-brutal-ice w-full py-4 text-xl shadow-brutal"><span x-show="!loading">ğŸ“§ Recevoir le lien de connexion</span> <span x-show="loading" x-cloak>â³ Envoi en cours...</span></button></form><p class="mt-4 text-sm text-center">Vous recevrez un email avec un lien magique pour vous connecter sans mot de passe.</p></div></div></section><section x-show="user" style="display:none"><div class="sticky top-0 z-40 brutal-card bg-brutal-white p-6 mb-8 flex flex-col md:flex-row md:justify-between md:items-center gap-4 shadow-brutal border-b-4 border-brutal-black"><div><p class="text-sm font-bold text-gray-600">Bienvenue,</p><p class="text-2xl font-black" x-text="user?.email"></p><span x-show="profiles.some(p => p.role === 'admin')" class="inline-block mt-2 px-3 py-1 bg-brutal-black text-brutal-white font-bold text-sm border-2 border-brutal-black">ğŸ” Administrateur</span></div><div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto"><a x-show="profiles.some(p => p.role === 'admin')" href="admin.html" class="brutal-btn bg-brutal-ice px-6 py-3 shadow-brutal-sm text-center">ğŸ” Admin </a><button @click="toggleProfileSection()" class="brutal-btn bg-brutal-white text-brutal-black px-6 py-3 shadow-brutal-sm w-full sm:w-auto border-2 border-brutal-black">ğŸ‘¤ GÃ©rer les profils</button> <button @click="logout()" class="brutal-btn bg-brutal-black text-brutal-white px-6 py-3 shadow-brutal-sm w-full sm:w-auto">Se dÃ©connecter</button></div></div><div x-show="user && (profiles.length === 0 || showProfileSection)" class="brutal-card bg-brutal-white p-8 mb-8"><div x-show="!isEditingProfile"><div class="flex justify-between items-center mb-6"><h2 class="text-3xl font-black">ğŸ‘¤ Mes BÃ©nÃ©voles</h2><button @click="createProfile()" class="brutal-btn bg-brutal-ice px-4 py-2 shadow-brutal-sm text-sm">+ Ajouter</button></div><div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3"><template x-for="p in profiles" :key="p.id"><div class="border-2 border-brutal-black p-4 bg-gray-50 relative"><h3 class="font-bold text-xl" x-text="p.prenom + ' ' + p.nom"></h3><p class="text-gray-600" x-text="p.email"></p><p class="text-sm mt-2">ğŸ‘• Taille: <span x-text="p.taille_tshirt"></span></p><button @click="editProfile(p.id)" class="mt-4 w-full brutal-btn bg-white border-2 border-black py-2 text-sm hover:bg-gray-100">âœï¸ Modifier</button></div></template><div x-show="profiles.length === 0" class="col-span-full text-center py-8 text-gray-500 italic">Aucun profil bÃ©nÃ©vole. CrÃ©ez-en un pour commencer !</div></div><div class="mt-6 text-right" x-show="profiles.length > 0"><button @click="toggleProfileSection()" class="underline font-bold text-gray-600">Fermer et voir les postes</button></div></div><div x-show="isEditingProfile"><h2 class="text-3xl font-black mb-6" x-text="profileForm.id ? 'Modifier le profil' : 'Nouveau bÃ©nÃ©vole'"></h2><form @submit.prevent="saveProfile()"><div class="grid md:grid-cols-2 gap-4 mb-4"><div><label class="block font-bold mb-2">PrÃ©nom *</label> <input x-model="profileForm.prenom" required class="brutal-input w-full px-4 py-3" placeholder="Jean"/></div><div><label class="block font-bold mb-2">Nom *</label> <input x-model="profileForm.nom" required class="brutal-input w-full px-4 py-3" placeholder="Dupont"/></div></div><div class="mb-4"><label class="block font-bold mb-2">TÃ©lÃ©phone</label> <input type="tel" x-model="profileForm.telephone" class="brutal-input w-full px-4 py-3" placeholder="06 12 34 56 78"/></div><div class="mb-6"><label class="block font-bold mb-2">Taille T-shirt *</label> <select x-model="profileForm.taille_tshirt" required class="brutal-input w-full px-4 py-3 font-bold"><option value="">-- SÃ©lectionnez --</option><option value="XS">XS</option><option value="S">S</option><option value="M">M</option><option value="L">L</option><option value="XL">XL</option><option value="XXL">XXL</option></select></div><div class="flex flex-col md:flex-row gap-4"><button type="submit" :disabled="loading" class="brutal-btn bg-brutal-ice w-full py-4 text-xl shadow-brutal"><span x-show="!loading">âœ… Enregistrer</span> <span x-show="loading">â³ Enregistrement...</span></button> <button type="button" @click="cancelEdit()" class="brutal-btn bg-gray-200 text-black w-full md:w-auto py-4 text-xl shadow-brutal-sm">Annuler</button></div></form></div></div><div x-show="profiles.length > 0 && !showProfileSection"><div class="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4"><h2 class="text-4xl font-black text-brutal-black">ğŸ“‹ Postes disponibles</h2><div class="flex flex-wrap gap-3"><button @click="showMyInscriptions = !showMyInscriptions" class="brutal-btn px-4 py-2 text-sm font-bold border-2 border-brutal-black shadow-brutal-sm transition-all active:scale-95 flex items-center gap-2" :class="showMyInscriptions ? 'bg-brutal-black text-brutal-white' : 'bg-white text-brutal-black'"><span x-text="showMyInscriptions ? 'âœ…' : 'â¬œ'"></span> <span>Mes inscriptions</span></button></div></div><template x-for="group in groupedPostes" :key="group.name"><div class="mb-12" x-data="{ open: true }"><div @click="open = !open" class="brutal-card bg-brutal-black text-brutal-white p-6 mb-6 cursor-pointer hover:bg-gray-900 transition-colors flex justify-between items-center select-none"><div><h3 class="text-3xl font-black uppercase tracking-wide" x-text="group.name"></h3><div class="mt-2 flex items-center gap-4"><span class="font-bold text-lg">ğŸ“Š <span x-text="group.postes.length"></span> poste<span x-show="group.postes.length > 1">s</span> </span><span class="font-bold text-lg">ğŸ‘¥ <span x-text="group.postes.reduce((sum, p) => sum + p.inscrits_actuels, 0)"></span> / <span x-text="group.postes.reduce((sum, p) => sum + p.nb_max, 0)"></span> inscrit<span x-show="group.postes.reduce((sum, p) => sum + p.inscrits_actuels, 0) > 1">s</span></span></div></div><div class="text-4xl transform transition-transform duration-300" :class="open ? 'rotate-180' : ''">â–¼</div></div><div class="grid gap-6" x-show="open" x-transition><template x-for="poste in group.postes" :key="poste.poste_id"><div><div class="brutal-card p-6" :class="isUserRegistered(poste.poste_id) ? 'bg-green-50' : 'bg-brutal-white'"><div class="mb-4 flex flex-col md:flex-row md:items-center md:gap-6"><h4 class="text-2xl font-black" x-text="poste.titre"></h4><p class="text-lg font-bold text-gray-700">ğŸ“… <span x-text="formatDate(poste.periode_debut)"></span> - <span x-text="formatTime(poste.periode_debut)"></span> Ã  <span x-text="formatTime(poste.periode_fin)"></span></p><div x-show="poste.referent_nom" class="md:ml-auto"><p class="font-bold">ğŸ‘¤ RÃ©fÃ©rent : <span x-text="poste.referent_nom"></span></p></div></div><div x-show="poste.description" class="mb-4 p-4 bg-gray-100 border-3 border-brutal-black"><p class="font-bold" x-text="poste.description"></p></div><div class="mb-4"><div class="flex justify-between mb-2"><span class="font-bold">Inscrits</span> <span class="font-black" x-text="poste.inscrits_actuels + ' / ' + poste.nb_max"></span></div><div class="progress-bar"><div class="progress-fill" :class="{
                        'bg-green-500': (poste.inscrits_actuels / poste.nb_max) < 0.7,
                        'bg-orange-500': (poste.inscrits_actuels / poste.nb_max) >= 0.7 && (poste.inscrits_actuels / poste.nb_max) < 0.9,
                        'bg-red-500': (poste.inscrits_actuels / poste.nb_max) >= 0.9
                      }" :style="'width: ' + ((poste.inscrits_actuels / poste.nb_max) * 100) + '%'"></div></div></div><div x-show="poste.liste_benevoles && poste.liste_benevoles.length > 0" class="mb-4"><p class="font-bold mb-2">BÃ©nÃ©voles inscrits :</p><div class="flex flex-wrap gap-2"><template x-for="benevole in poste.liste_benevoles" :key="benevole"><span class="px-3 py-1 bg-brutal-black text-brutal-white font-bold text-sm border-2 border-brutal-black"><span x-text="benevole"></span></span></template></div></div><div class="flex flex-col sm:flex-row gap-4 mt-6"><button x-show="profiles.length > 0" @click="openRegistrationModal(poste)" class="brutal-btn bg-brutal-ice w-full py-3 text-lg shadow-brutal-sm">ğŸ“ Inscrire / DÃ©sinscrire</button><p x-show="profiles.length === 0" class="text-red-600 font-bold italic">CrÃ©ez un profil bÃ©nÃ©vole pour vous inscrire.</p></div></div></div></template></div></div></template></div><div x-show="selectedPosteForRegistration" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm" x-transition.opacity><div class="brutal-card bg-brutal-white p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto relative" @click.outside="closeRegistrationModal()"><button @click="closeRegistrationModal()" class="absolute top-4 right-4 text-2xl font-black hover:text-red-500">âœ•</button><template x-if="selectedPosteForRegistration"><div><h2 class="text-3xl font-black mb-2">Inscription</h2><p class="text-xl font-bold text-gray-600 mb-6" x-text="selectedPosteForRegistration.titre"></p><div class="mb-6 p-4 bg-gray-100 border-2 border-black"><p>ğŸ“… <span x-text="formatDate(selectedPosteForRegistration.periode_debut)"></span></p><p>â° <span x-text="formatTime(selectedPosteForRegistration.periode_debut)"></span> - <span x-text="formatTime(selectedPosteForRegistration.periode_fin)"></span></p><p class="mt-2">Places : <span x-text="selectedPosteForRegistration.inscrits_actuels + ' / ' + selectedPosteForRegistration.nb_max"></span></p></div><h3 class="text-xl font-bold mb-4">Qui souhaitez-vous inscrire ?</h3><div class="space-y-4"><template x-for="profile in profiles" :key="profile.id"><div class="flex items-center justify-between p-4 border-2 border-black" :class="isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id) ? 'bg-green-100' : (hasTimeConflict(selectedPosteForRegistration, profile.id) ? 'bg-gray-200 opacity-75' : 'bg-white')"><div><p class="font-black text-lg" x-text="profile.prenom + ' ' + profile.nom"></p><div class="mt-1"><span x-show="isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id)" class="text-xs font-bold text-green-700 bg-green-200 px-2 py-1">âœ… Inscrit </span><span x-show="!isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id) && hasTimeConflict(selectedPosteForRegistration, profile.id)" class="text-xs font-bold text-red-700 bg-red-200 px-2 py-1">âš ï¸ Conflit horaire</span></div></div><div><button x-show="isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id)" @click="unregister(selectedPosteForRegistration.poste_id, profile.id)" class="brutal-btn bg-red-500 text-white px-4 py-2 text-sm shadow-brutal-sm">DÃ©sinscrire</button> <button x-show="!isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id) && !hasTimeConflict(selectedPosteForRegistration, profile.id) && selectedPosteForRegistration.inscrits_actuels < selectedPosteForRegistration.nb_max" @click="register(selectedPosteForRegistration.poste_id, profile.id)" class="brutal-btn bg-brutal-ice px-4 py-2 text-sm shadow-brutal-sm">Inscrire</button> <button disabled="disabled" x-show="!isProfileRegistered(selectedPosteForRegistration.poste_id, profile.id) && (hasTimeConflict(selectedPosteForRegistration, profile.id) || selectedPosteForRegistration.inscrits_actuels >= selectedPosteForRegistration.nb_max)" class="brutal-btn bg-gray-300 text-gray-500 px-4 py-2 text-sm cursor-not-allowed"><span x-show="hasTimeConflict(selectedPosteForRegistration, profile.id)">Indisponible</span> <span x-show="!hasTimeConflict(selectedPosteForRegistration, profile.id) && selectedPosteForRegistration.inscrits_actuels >= selectedPosteForRegistration.nb_max">Complet</span></button></div></div></template></div></div></template></div></div></section></main></body></html>